# Java
* [JVM의 구조와 Java의 실행방식](#jvm의-구조)

## JVM의 구조
JVM은 Java를 **운영체제에 독립적**으로 실행될 수 있도록 해주고 가비지 컬렉터로 **메모리 관리**를 자동으로 해준다.   
![JVM구조]()

### Class Loader
.class 파일(바이트코드)들을 JVM 메모리영역(Runtime Data Area)으로 **로딩**시킨다.

### Runtime Data Area
Method Area
* 모든 스레드가 **공유**
* **JVM이 시작될 때** 생성되는 공간으로 바이트코드가 이 영역에 저장된다.
* 클래스 정보, 변수 정보, static으로 선언한 변수가 저장된다.   

Heap
* 모든 스레드가 **공유**
* **동적으로 생성된 객체**가 저장되는 영역이다.
* new 연산을 통해 동적으로 생성된 인스턴스 변수가 저장된다.
  * 클래스의 객체, 배열 등이 있다.
* 생성된 인스턴스 변수는 해당 객체가 소멸되기 전이나 가비지 컬렉터가 정리하기 전까지는 이 영역에 남아있다.   
  * 쉽게 소멸되는 데이터가 아니다.
* GC의 대상이 되는 공간이다.
  * 효율적인 GC를 위해서 5가지 영역으로 나뉜다.   

Stack
* 스레드마다 1개씩 생성된다.
* 지역변수나 메서드의 매개변수, 임시적으로 사용되는 변수, 메서드의 정보가 저장되는 영역이다.   
* 해당 메서드의 호출이 종료되면 이 안에 선언된 변수들은 사라진다.   
* 즉 금방 사용되고 사용이 끝나는 데이터가 저장되는 영역이다.

> Stack, Heap 예시
```
Person p = new Person("박성민", 31);
```
변수 p는 Stack에 저장된다.   
동적으로 생성한 Person 객체 자체는 Heap 영역에 저장된다.   
Reference Type의 진짜 메모리는 Heap 영역에 저장된다.   
* 그 메모리의 주소를 참조하는 변수는 Stack 영역에 저장된다.

PC Register
* 스레드마다 1개씩 생성된다.
* 운영체제를 공부할때 나오는 CPU Register 내부의 Program Counter랑은 다른 것이다.
* 현재 수행중인 JVM의 명령어 주소를 저장하는 공간이다.
  * 즉 스레드가 어떤 부분을 명령어로 수행할지를 저장하는 공간이다. 

Native Method Stack
* 스레드마다 1개씩 생성된다.
* Java가 아닌 다른 언어로 작성된 코드를 위한 공간이다.
  * 즉, JNI(Java Native Interface)를 통해 호출하는 C/C++등의 코드를 수행하기 위한 공간이다.
  * 바이트코드가 아닌 실제 실행할 수 있는 기계어로 작성된 프로그램을 실행시키는 영역이다.

### Execution Engine
Runtime Data Area에 로딩된 클래스파일을 해석해준다.   
로드된 클래스파일의 바이트코드를 실행하는 엔진이다.   
바이트코드를 실행시키기 위해서는 컴퓨터가 이해할 수 있는 기계어로 바꾸는 작업이 필요하다.      
* Interpreter
  * 명령어를 한줄 한줄 해석하면서 실행한다.
* JIT Complier (Just In Time Complier)
  * Interpreter의 단점을 해결하기 위한 방법으로, 런타임시간에 한꺼번에 변경하여 실행한다.

이제 이렇게 기계어로 해석된 것들이 Runtime Data Area에 배치되어 스레드 동기화나 가비지 컬렉션을 수행하게 된다.

### Native Method Interface(JNI)
JVM에 의해 실행되는 코드 중 네이티브로 실행하는 것이 있다면 해당 네이티브 코드를 호출하거나 호출 될 수 있도록 만든 일종의 프레임워크이다.

### Native Method Libraries
네이티브 메소드 실행에 필요한 라이브러리

### 참고
* [자바 메모리 구조 뿌시기 [ JVM이란? ]](https://youtu.be/AWXPnMDZ9I0)
* [JVM 구조](https://goodgid.github.io/Java-JVM/)